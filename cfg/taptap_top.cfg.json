{
  "id": 18,
  "name": "taptap_top",
  "display_name": "taptap排行榜",
  "remark": "taptap热门榜：https://www.taptap.com/top/download",
  "tags": "[\"taptap\",\"top\"]",
  "start_urls": [
    "https://www.taptap.com/ajax/top/download?total=30\u0026page=1"
  ],
  "start_stage": "list_games",
  "cron": "",
  "enable_cron": false,
  "create_time": "2020-09-10T13:44:41.653487Z",
  "update_time": "2020-09-10T15:15:15.373839Z",
  "stages": [
    {
      "id": 363,
      "project_id": 18,
      "name": "list_games",
      "is_list": true,
      "is_unique": false,
      "list_xpath": "",
      "list_css": "div.taptap-top-card",
      "page_xpath": "",
      "page_css": "",
      "page_attr": "",
      "plugins": "extract_html@s2",
      "plugin_array": [
        {
          "id": 57,
          "name": "extract_html",
          "script": "(function(){\n  // Plugin Name: extract_html\n  // Start here...\n  var respJson = JSON.parse(RESPONSE_DATA());\n  // 下一页\n  if (respJson.data.next != \"\") {\n    ADD_QUEUE({\n      stage: \"list_games\",\n      url: respJson.data.next\n    });\n  }\n  return \"\u003chtml\u003e\" + respJson.data.html + \"\u003c/html\u003e\";\n})()",
          "slot": "s2",
          "project_id": 18
        }
      ],
      "fields": [
        {
          "id": 1355,
          "project_id": 18,
          "stage_id": 363,
          "name": "game_url",
          "is_array": false,
          "is_html": false,
          "xpath": "",
          "css": "div.top-card-middle\u003ea",
          "attr": "href",
          "plugin": "",
          "_plugin": null,
          "remark": "",
          "next_stage": "game_detail"
        }
      ],
      "has_next_stage": true
    },
    {
      "id": 364,
      "project_id": 18,
      "name": "game_detail",
      "is_list": false,
      "is_unique": false,
      "list_xpath": "",
      "list_css": "",
      "page_xpath": "",
      "page_css": "",
      "page_attr": "",
      "plugins": "get_user_reviews@s2",
      "plugin_array": [
        {
          "id": 59,
          "name": "get_user_reviews",
          "script": "(function(){\n  // Plugin Name: get_user_reviews\n  // Start here...\n  // 获取用户评价标签列表\n  // https://www.taptap.com/app/171598\n  // https://www.taptap.com/ajax/app/171598/review-list\n  var url = QUEUE().Url;\n  var id = SUBSTR(url, url.lastIndexOf(\"/\")+1, LEN(url))\n  // console.log(\"id=\" + id);\n  var reviewdata = AJAX(\"GET\", \"https://www.taptap.com/ajax/app/\"+ id +\"/review-list\", {\n  \t \"User-Agent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/537.36 (KHTML,likeGecko) Chrome/78.0.3904.108 Safari/537.36\"\n  }, {}, {})\n  var data = JSON.parse(reviewdata.data);\n  // 在原始的html中插入用户评价html，然后一起解析\n  return REPLACE(RESPONSE_DATA(), \"\u003c/body\u003e\\n\u003c/html\u003e\", \"\") + data.data.html + \"\\n\u003c/body\u003e\\n\u003c/html\u003e\"\n})()",
          "slot": "s2",
          "project_id": 18
        }
      ],
      "fields": [
        {
          "id": 1356,
          "project_id": 18,
          "stage_id": 364,
          "name": "icon",
          "is_array": false,
          "is_html": false,
          "xpath": "",
          "css": "div.show-main-header\u003ediv.main-header-icon\u003ediv.header-icon-body\u003eimg",
          "attr": "src",
          "plugin": "",
          "_plugin": null,
          "remark": "",
          "next_stage": ""
        },
        {
          "id": 1357,
          "project_id": 18,
          "stage_id": 364,
          "name": "name",
          "is_array": false,
          "is_html": false,
          "xpath": "",
          "css": "div.show-main-header\u003ediv.main-header-text\u003ediv.base-info-wrap\u003eh1",
          "attr": "",
          "plugin": "",
          "_plugin": null,
          "remark": "游戏名称",
          "next_stage": ""
        },
        {
          "id": 1358,
          "project_id": 18,
          "stage_id": 364,
          "name": "author",
          "is_array": false,
          "is_html": false,
          "xpath": "",
          "css": "div.show-main-header\u003ediv.main-header-text\u003ediv.base-info-wrap\u003ediv.header-text-author\u003ea\u003espan:nth-last-child(1)",
          "attr": "",
          "plugin": "",
          "_plugin": null,
          "remark": "厂商",
          "next_stage": ""
        },
        {
          "id": 1359,
          "project_id": 18,
          "stage_id": 364,
          "name": "rating",
          "is_array": false,
          "is_html": false,
          "xpath": "",
          "css": "span.app-rating-score",
          "attr": "",
          "plugin": "",
          "_plugin": null,
          "remark": "taptap评分",
          "next_stage": ""
        },
        {
          "id": 1360,
          "project_id": 18,
          "stage_id": 364,
          "name": "install_count",
          "is_array": false,
          "is_html": false,
          "xpath": "",
          "css": "p.description\u003espan:nth-child(1)",
          "attr": "",
          "plugin": "remove_suffix@s4",
          "_plugin": {
            "id": 58,
            "name": "remove_suffix",
            "script": "(function(){\n  // Plugin Name: remove_suffix\n  // Start here...\n  var val = ENV(\"currentFieldValue\");\n  var len = LEN(val);\n  return TRIM(SUBSTR(val, 0, len - 3));\n})()",
            "slot": "s4",
            "project_id": 18
          },
          "remark": "安装人数",
          "next_stage": ""
        },
        {
          "id": 1361,
          "project_id": 18,
          "stage_id": 364,
          "name": "star_count",
          "is_array": false,
          "is_html": false,
          "xpath": "",
          "css": "p.description\u003espan:nth-child(2)",
          "attr": "",
          "plugin": "remove_suffix@s4",
          "_plugin": {
            "id": 58,
            "name": "remove_suffix",
            "script": "(function(){\n  // Plugin Name: remove_suffix\n  // Start here...\n  var val = ENV(\"currentFieldValue\");\n  var len = LEN(val);\n  return TRIM(SUBSTR(val, 0, len - 3));\n})()",
            "slot": "s4",
            "project_id": 18
          },
          "remark": "关注人数",
          "next_stage": ""
        },
        {
          "id": 1362,
          "project_id": 18,
          "stage_id": 364,
          "name": "videos",
          "is_array": true,
          "is_html": false,
          "xpath": "",
          "css": "ul#imageShots\u003eli video",
          "attr": "data-src",
          "plugin": "",
          "_plugin": null,
          "remark": "宣传视频",
          "next_stage": ""
        },
        {
          "id": 1363,
          "project_id": 18,
          "stage_id": 364,
          "name": "screenshots",
          "is_array": true,
          "is_html": false,
          "xpath": "",
          "css": "ul#imageShots\u003eli\u003ea",
          "attr": "href",
          "plugin": "",
          "_plugin": null,
          "remark": "截图",
          "next_stage": ""
        },
        {
          "id": 1364,
          "project_id": 18,
          "stage_id": 364,
          "name": "developer_speak",
          "is_array": false,
          "is_html": true,
          "xpath": "",
          "css": "div#developer-speak",
          "attr": "",
          "plugin": "",
          "_plugin": null,
          "remark": "开发者的话",
          "next_stage": ""
        },
        {
          "id": 1365,
          "project_id": 18,
          "stage_id": 364,
          "name": "group_number",
          "is_array": false,
          "is_html": false,
          "xpath": "",
          "css": "div.main-body-number\u003ep",
          "attr": "",
          "plugin": "",
          "_plugin": null,
          "remark": "交流群",
          "next_stage": ""
        },
        {
          "id": 1366,
          "project_id": 18,
          "stage_id": 364,
          "name": "additional",
          "is_array": true,
          "is_html": false,
          "xpath": "",
          "css": "ul.main-body-additional\u003eli\u003espan",
          "attr": "",
          "plugin": "",
          "_plugin": null,
          "remark": "附加信息",
          "next_stage": ""
        },
        {
          "id": 1367,
          "project_id": 18,
          "stage_id": 364,
          "name": "tags",
          "is_array": true,
          "is_html": false,
          "xpath": "",
          "css": "ul#appTag\u003eli\u003ea",
          "attr": "",
          "plugin": "",
          "_plugin": null,
          "remark": "游戏标签",
          "next_stage": ""
        },
        {
          "id": 1368,
          "project_id": 18,
          "stage_id": 364,
          "name": "description",
          "is_array": false,
          "is_html": true,
          "xpath": "",
          "css": "div#description",
          "attr": "",
          "plugin": "",
          "_plugin": null,
          "remark": "游戏简介",
          "next_stage": ""
        },
        {
          "id": 1369,
          "project_id": 18,
          "stage_id": 364,
          "name": "game_size",
          "is_array": false,
          "is_html": false,
          "xpath": "//span[@class=\"info-item-title\" and text()=\"文件大小:\"]/../span[@class=\"info-item-content\"]",
          "css": "",
          "attr": "",
          "plugin": "",
          "_plugin": null,
          "remark": "游戏大小",
          "next_stage": ""
        },
        {
          "id": 1370,
          "project_id": 18,
          "stage_id": 364,
          "name": "cur_version",
          "is_array": false,
          "is_html": false,
          "xpath": "//span[@class=\"info-item-title\" and text()=\"当前版本:\"]/../span[@class=\"info-item-content\"]",
          "css": "",
          "attr": "",
          "plugin": "",
          "_plugin": null,
          "remark": "当前版本",
          "next_stage": ""
        },
        {
          "id": 1371,
          "project_id": 18,
          "stage_id": 364,
          "name": "updated_date",
          "is_array": false,
          "is_html": false,
          "xpath": "//span[@class=\"info-item-title\" and text()=\"更新时间:\"]/../span[@class=\"info-item-content\"]",
          "css": "",
          "attr": "",
          "plugin": "",
          "_plugin": null,
          "remark": "更新时间",
          "next_stage": ""
        },
        {
          "id": 1372,
          "project_id": 18,
          "stage_id": 364,
          "name": "user_reviews",
          "is_array": true,
          "is_html": false,
          "xpath": "",
          "css": "ul#review-label-list\u003eli\u003ediv\u003ea",
          "attr": "",
          "plugin": "",
          "_plugin": null,
          "remark": "用户评价",
          "next_stage": ""
        },
        {
          "id": 1373,
          "project_id": 18,
          "stage_id": 364,
          "name": "user_review_count",
          "is_array": false,
          "is_html": false,
          "xpath": "//a[@data-taptap-tab=\"review\"]/small",
          "css": "",
          "attr": "",
          "plugin": "",
          "_plugin": null,
          "remark": "用户评价数",
          "next_stage": ""
        }
      ],
      "has_next_stage": false
    }
  ],
  "headers": {
    "User-Agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/78.0.3904.108 Safari/537.36",
    "accept-language": "zh-CN,zh;q=0.9,en;q=0.8,ja;q=0.7,zh-TW;q=0.6"
  },
  "settings": {
    "CONCURRENT_REQUESTS": "5"
  },
  "node_affinity": [
    ""
  ],
  "node_affinity_parsed": null,
  "extras": null
}